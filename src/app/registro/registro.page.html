<ion-header>
  <!-- Botón de navegación para volver a la página de inicio de sesión -->
  <ion-buttons slot="start">
    <ion-back-button defaultHref="/login"></ion-back-button>
  </ion-buttons>
  <ion-toolbar>
    <!-- Título de la página -->
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="container">
    <!-- Logo de la aplicación -->
    <div class="text-center mb-4">
      <img src="./assets/img/logo.png" alt="Logo" class="img-fluid">
    </div>
    <!-- Formulario de registro -->
    <form (ngSubmit)="onSubmit(registroForm)" #registroForm="ngForm" novalidate>
      <!-- Campo para el RUT -->
      <ion-item>
        <ion-label position="floating">RUT</ion-label>
        <ion-input type="text" name="rut" [(ngModel)]="rut" required></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['rut']?.dirty && registroForm.controls['rut']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['rut']?.errors?.['required']">El RUT es requerido.</ion-text>
      </div>

      <!-- Campo para el nombre -->
      <ion-item>
        <ion-label position="floating">Nombre</ion-label>
        <ion-input type="text" name="nombre" [(ngModel)]="nombre" required pattern="^[a-zA-Z\s]+$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['nombre']?.dirty && registroForm.controls['nombre']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['nombre']?.errors?.['required']">El nombre es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['nombre']?.errors?.['pattern']">El nombre solo puede contener letras.</ion-text>
      </div>

      <!-- Campo para el apellido -->
      <ion-item>
        <ion-label position="floating">Apellido</ion-label>
        <ion-input type="text" name="apellido" [(ngModel)]="apellido" required pattern="^[a-zA-Z\s]+$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['apellido']?.dirty && registroForm.controls['apellido']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['apellido']?.errors?.['required']">El apellido es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['apellido']?.errors?.['pattern']">El apellido solo puede contener letras.</ion-text>
      </div>

      <!-- Campo para el email -->
      <ion-item>
        <ion-label position="floating">Email</ion-label>
        <ion-input type="email" name="correo" [(ngModel)]="correo" required email></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['correo']?.dirty && registroForm.controls['correo']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['correo']?.errors?.['required']">El email es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['correo']?.errors?.['correo']">Debe ser un correo electrónico válido.</ion-text>
      </div>

      <!-- Campo para la dirección -->
      <ion-item>
        <ion-label position="floating">Dirección de Envío</ion-label>
        <ion-input type="text" name="direccion" [(ngModel)]="direccion" required></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['direccion']?.dirty && registroForm.controls['direccion']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['direccion']?.errors?.['required']">La dirección es requerida.</ion-text>
      </div>

         <!-- Campo para el teléfono -->
         <ion-item>
          <ion-label position="floating">Teléfono</ion-label>
          <ion-input type="tel" name="telefono" [(ngModel)]="telefono" required pattern="^\+?[0-9\s]+$"></ion-input>
        </ion-item>
        <div *ngIf="registroForm.submitted || (registroForm.controls['telefono']?.dirty && registroForm.controls['telefono']?.invalid)">
          <ion-text color="danger" *ngIf="registroForm.controls['telefono']?.errors?.['required']">El teléfono es requerido.</ion-text>
          <ion-text color="danger" *ngIf="registroForm.controls['telefono']?.errors?.['pattern']">El teléfono solo puede contener números y el símbolo +.</ion-text>
        </div>
      

      <!-- Campo para la contraseña -->
      <ion-item>
        <ion-label position="floating">Contraseña</ion-label>
        <ion-input type="password" name="contrasena" [(ngModel)]="contrasena" required pattern="^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['contrasena']?.dirty && registroForm.controls['contrasena']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['contrasena']?.errors?.['required']">La contraseña es requerida.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['contrasena']?.errors?.['pattern']">La contraseña debe tener al menos 8 caracteres, una mayúscula y un número.</ion-text>
      </div>

      <!-- Campo para confirmar la contraseña -->
      <ion-item>
        <ion-label position="floating">Confirmar Contraseña</ion-label>
        <ion-input type="password" name="confirmarContrasena" [(ngModel)]="confirmarContrasena" required></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['confirmarContrasena']?.dirty && registroForm.controls['confirmarContrasena']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['confirmarContrasena']?.errors?.['required']">Confirmar contraseña es requerido.</ion-text>
        <ion-text color="danger" *ngIf="contrasena !== confirmarContrasena">Las contraseñas no coinciden.</ion-text>
      </div>

      <!-- Campo para cargar la foto del usuario -->
      <ion-item>
        <ion-label position="floating">Foto de Usuario</ion-label>
        <ion-input type="file" name="foto_usuario" (change)="onFileSelected($event)"></ion-input>
      </ion-item>

      <!-- Botón para enviar el formulario -->
      <ion-button expand="full" type="submit" [disabled]="registroForm.invalid" class="mt-3">Registrarse</ion-button>
    </form>
  </div>
</ion-content>
