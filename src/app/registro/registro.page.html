<ion-header>
  <ion-buttons slot="start">
    <ion-back-button defaultHref="/login"></ion-back-button>
  </ion-buttons>
  <ion-toolbar>
    <ion-title>Registro</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <div class="container">
    <div class="text-center mb-4">
      <img src="./assets/img/logo.png" alt="Logo" class="img-fluid">
    </div>
    <form (ngSubmit)="onSubmit(registroForm)" #registroForm="ngForm" novalidate>
      <ion-item>
        <ion-label position="floating">Nombre</ion-label>
        <ion-input type="text" name="nombre" [(ngModel)]="nombre" required pattern="^[a-zA-Z\s]+$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['nombre']?.dirty && registroForm.controls['nombre']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['nombre']?.errors?.['required']">El nombre es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['nombre']?.errors?.['pattern']">El nombre solo puede contener letras.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Apellido</ion-label>
        <ion-input type="text" name="apellido" [(ngModel)]="apellido" required pattern="^[a-zA-Z\s]+$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['apellido']?.dirty && registroForm.controls['apellido']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['apellido']?.errors?.['required']">El apellido es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['apellido']?.errors?.['pattern']">El apellido solo puede contener letras.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Email</ion-label>
        <ion-input type="email" name="email" [(ngModel)]="email" required email></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['email']?.dirty && registroForm.controls['email']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['email']?.errors?.['required']">El email es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['email']?.errors?.['email']">Debe ser un correo electrónico válido.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Teléfono</ion-label>
        <ion-input type="tel" name="telefono" [(ngModel)]="telefono" required pattern="^\+?[0-9\s]+$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['telefono']?.dirty && registroForm.controls['telefono']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['telefono']?.errors?.['required']">El teléfono es requerido.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['telefono']?.errors?.['pattern']">El teléfono solo puede contener números y el símbolo +.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Dirección de Envío</ion-label>
        <ion-input type="text" name="direccion" [(ngModel)]="direccion" required></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['direccion']?.dirty && registroForm.controls['direccion']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['direccion']?.errors?.['required']">La dirección es requerida.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Contraseña</ion-label>
        <ion-input type="password" name="contrasena" [(ngModel)]="contrasena" required pattern="^(?=.*[A-Z])(?=.*\d)[A-Za-z\d]{8,}$"></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['contrasena']?.dirty && registroForm.controls['contrasena']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['contrasena']?.errors?.['required']">La contraseña es requerida.</ion-text>
        <ion-text color="danger" *ngIf="registroForm.controls['contrasena']?.errors?.['pattern']">La contraseña debe tener al menos 8 caracteres, una mayúscula y un número.</ion-text>
      </div>

      <ion-item>
        <ion-label position="floating">Confirmar Contraseña</ion-label>
        <ion-input type="password" name="confirmar_contrasena" [(ngModel)]="confirmarContrasena" required></ion-input>
      </ion-item>
      <div *ngIf="registroForm.submitted || (registroForm.controls['confirmar_contrasena']?.dirty && registroForm.controls['confirmar_contrasena']?.invalid)">
        <ion-text color="danger" *ngIf="registroForm.controls['confirmar_contrasena']?.errors?.['required']">Confirmar contraseña es requerido.</ion-text>
        <ion-text color="danger" *ngIf="contrasena !== confirmarContrasena">Las contraseñas no coinciden.</ion-text>
      </div>

      <ion-button expand="full" type="submit" [disabled]="registroForm.invalid" class="mt-3">Registrarse</ion-button>
    </form>
  </div>
</ion-content>